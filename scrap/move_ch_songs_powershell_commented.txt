<#
NOTE: This file contains Copilot suggestions, with all comments either paraphrased or taken directly from Copilot.
#>

Clear-Host
# These are fine - PS handles quoted strings well.
$dowf = "$Env:USERPROFILE\Game downloads\for clone hero"
$extr_f="$Env:USERPROFILE\downloads"
$songf="$Env:USERPROFILE\Documents\Clone Hero\Songs"

if (-not Test-Path $extr_f) {
	New-Item -ItemType Directory -Path "$Env:USERPROFILE\downloads" }
<#
ISSUES:

1) '$file' is never defined.
2) Inside the pipeline, the current object is '$_'
3) 'Extension -eq ".zip*"' is invalid - PS does NOT use wildcard matching with equality comparisons.
4) 'Move-Item "$extr_f"' is incomplete - you didn't specifiy WHAT to move.

#>

<#
CORRECTED BLOCK:

Get-ChildItem $dowf -Filter *.zip |
    Where-Object { $_.LastWriteTime -gt (Get-Date).AddDays(-10) } |
    Move-Item -Destination $extr_f -Force

Explained:

1) '$_' refers to the current file object.
2) '-Filter *.zip' handles extension matching.
3) 'Move-Item' receives the actual file object from the pipeline.
4) 'if($file.Extension -eq ".zip*)' is incorrect wildcard usage:
	-'.Extension' returns exactly '.zip'
	-PS does NOT treat ".zip*" as a wildcard pattern with '-eq'
	-You must use '-like' for wildcard matching.
#>
Get-ChildItem "$dowf" | ForEach-Object {
	if ($file.Extension -eq ".zip*" -and $file.CreationTime -ge (Get-Date).AddDays(-10)) {
		Move-Item "$extr_f"} 
	} # the 'if' statement should say either 'if($_.Extension -eq ".zip")' OR 'if($_.Name -like "*.zip"'; see above explanation 

Write-Host "Extracting ZIPs..."
<#
ISSUES:

1) "extr_f" written as literal string, missing the '$'
2) PS does NOT expand variables inside quotes unless you use "..." and include '$' inside the string
3) 'Get-ChildItem "extr_f" | foreach ($f in Get-ChildItem) {' is incorrect loop syntax.
	-"extr_f" missing the '$'
	-'foreach ($f in Get-ChildItem)' is invalid - Get-ChildItem requires a Path
	-You're mixing pipeline 'ForEach-Object' with 'foreach()' syntax; they're entirely different things.
4) 'Expand-Archive -Path "$extr_f" -Force -DestinationPath "$songf"' is invalid - '-Path' must be a ZIP file, not a directory. Instead of the file '$f' being extracted, the entire ;'$extr_f' folder is being extracted instead.
#>

<#
CORRECTED BLOCK:

foreach ($f in Get-ChildItem $extr_f -Filter *.zip) {
    Expand-Archive -Path $f.FullName -DestinationPath $extr_f -Force
}
#>

Get-ChildItem "extr_f" | foreach ($f in Get-ChildItem) {
	if ($file.Extension -eq ".zip*") {
		Write-Host "Extracting $file.Name"
		Expand-Archive -Path "$extr_f" -Force -DestinationPath "$songf"}
	}

<#
ISSUES:

1) ".zip" is not a valid filter - PS expects "*.zip" Instead
2) You've used quotes around '$extr_f', making it a literal string
#>

<#
Corrected:

Remove-Item -Path $extr_f -Filter *.zip -Force
#>
Write-Host "Cleanup..."
Remove-Item -Filter ".zip*" -Path "$extr_f"
Pause


<#
SUMMARY:
Your script intends to:

1) Move recent ZIPs
2) Extract them
3) Move extracted folders to Clone hero
4) Clean up ZIPs

But due to the issues listed, your script actually:

-Never identifies ZIPs correctly
-Never moves or extracts them
-Never moves extracted content
-Never deletes ZIPs
It runs without doing anything meaningful.


Why the refined script works:

-Uses Get-ChildItem with filters instead of manual extension checks
-Uses Where-Object for date filtering
-Uses Move-Item correctly with full paths
-Uses Expand-Archive on each ZIP file
-Moves extracted folders instead of the entire directory
-Cleans up ZIPs safely
-Avoids mixing pipeline loops with 'foreach()' loops
-Uses variables correctly
-Avoids wildcard misuse
-Avoids undefined variables

#>